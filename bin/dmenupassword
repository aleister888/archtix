#!/bin/sh

# Encontrar bases de datos de keepassxc
DATABASES=$(find ~/ -name "*.kdbx")

# Función para notificaciones
knotify() { notify-send -i keepassxc "$1"; }
# Función para abrir las base de datos con dmenu
kopen() { true | dmenu -P -p " " | keepassxc --pw-stdin "$1"; }

if [ -z "$DATABASES" ]; then
    knotify "No se encontró ninguna base de contraseñas"
elif [ $(echo "$DATABASES" | wc -l) -gt 2 ]; then
    SELECTED=$(echo "$DATABASES" | dmenu -p " Elige la base de datos")
    knotify "$(basename "$SELECTED"): Introduce la contraseña"
    kopen "$SELECTED"
else
    knotify "$(basename "$DATABASES"): Introduce la contraseña"
    kopen "$DATABASES"
fi
