#!/bin/sh

# Script para instalar Steam y ponerlo en un sandbox con firejail

# Instalar Steam y Firejail
doas pacman -S --noconfirm --needed steam firejail

# Configurar Firejail
if ! grep -q "apparmor no" /etc/firejail/firejail.config; then
	echo "apparmor no" | doas tee -a /etc/firejail/firejail.config
fi

# Configurar kernel.unprivileged_userns_clone en sysctl.conf
if ! grep -q "kernel.unprivileged_userns_clone" /etc/sysctl.conf; then
	echo "kernel.unprivileged_userns_clone = 1" | doas tee -a /etc/sysctl.conf
fi

# Puedes activar firejail para todas las apps con:
# $ doas firecfg

# Tambi√©n puedes desactivarlo con:
# $	for file in $(/usr/bin/ls /usr/local/bin/)
# 		do [ "$(readlink $file)" = '/usr/bin/firejail' ] && doas rm "/usr/local/bin/$file"
# 	done

# Para instalarlo solo para Steam:
#doas ln -s /usr/bin/firejail /usr/local/bin/steam
